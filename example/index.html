<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta
            name="viewport"
            content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"
    />
    <meta http-equiv="X-UA-Compatible" content="ie=edge"/>
    <title>Secure Trading Example Form</title>
</head>

<body>
<form id="st-form" class="example-form" autocomplete="off" novalidate>
    <div id="st-popup"></div>
    <h1 class="example-form__title">
        Secure Trading<span>AMOUNT: <strong>10.00 GBP</strong></span>
    </h1>
    <div class="example-form__section example-form__section--horizontal">
        <div class="example-form__group">
            <label for="example-form-name" class="example-form__label">AMOUNT</label>
            <input
                    id="example-form-amount"
                    class="example-form__input"
                    type="number"
                    placeholder=""
                    name="myBillAmount"
                    data-st-name="billingamount"
            />
        </div>
    </div>

    <div class="example-form__section example-form__section--horizontal">
        <div class="example-form__group">
            <label for="example-form-name" class="example-form__label">NAME</label>
            <input
                    id="example-form-name"
                    class="example-form__input"
                    type="text"
                    placeholder="John Doe"
                    autocomplete="name"
                    name="myBillName"
                    data-st-name="billingfirstname"
            />
        </div>
        <div class="example-form__group">
            <label for="example-form-email" class="example-form__label">E-MAIL</label>
            <input
                    id="example-form-email"
                    class="example-form__input"
                    type="email"
                    placeholder="test@mail.com"
                    autocomplete="email"
                    name="myBillEmail"
                    data-st-name="billingemail"
            />
        </div>
        <div class="example-form__group">
            <label for="example-form-phone" class="example-form__label">PHONE</label>
            <input
                    id="example-form-phone"
                    class="example-form__input"
                    type="tel"
                    placeholder="+00 000 000 000"
                    autocomplete="tel"
                    name="myBillTel"
            />
            <!-- no data-st-name attribute so this field will not be submitted to ST -->
        </div>
    </div>

    <div class="example-form__spacer"></div>

    <div class="example-form__section">
        <div id="st-notification-frame" class="example-form__group"></div>
        <div id="st-card-number" class="example-form__group"></div>
        <div id="st-expiration-date" class="example-form__group"></div>
        <div id="st-security-code" class="example-form__group"></div>
        <div class="example-form__spacer"></div>
    </div>

    <div class="example-form__section">
        <div id="st-control-frame" class="example-form__group"></div>
        <div id="st-visa-checkout" class="example-form__group"></div>
        <div id="st-apple-pay" class="example-form__group"></div>
    </div>

    <div id="st-animated-card" class="example-form__st-animated-card"></div>

    <div class="example-form__section">
        <div class="example-form__group example-form__group--submit">
            <button type="submit" class="example-form__button" id="merchant-submit-button">Zapłać</button>
        </div>
    </div>
</form>
<script type="text/javascript" src="<%= WEBSERVICES_URL %>/st.js"></script>
  <script>
  (function () {
    const parsedUrl = new URL(window.location.href);

    const cardinalJwt='%s';
    const jwt  = parsedUrl.searchParams.get('jwt') || cardinalJwt;
    console.log(jwt);
    const st = SecureTrading({
      jwt,
      livestatus:0,
      submitOnSuccess:false,
      submitOnError:false,
      animatedCard:true,
      panIcon:true,
      disableNotification:false,
      animatedCard:true,
      submitCallback : callback,
      styles: {
        'background-color-input': '#e71b5a',
        'font-size-label': '18px',
        'color-input': '#fff',
        'line-height-body': '2px',
        'space-outset-body': '2px',
        'space-inset-body': '2px',
      }
    });
    function callback(data) { console.log(JSON.stringify(data)); }

    st.Components()
    st.VisaCheckout({
      buttonSettings: {
        size: '154',
        color: 'neutral'
      },
      livestatus: 0,
      merchantId: 'SDUT1MEXJO10RARJF2S521ImTyKfn3_JmxePdXcydQIUb4kx4',
      paymentRequest: {
        "currencyCode": "GBP",
        "subtotal": "10.99",
        "total": "10.99",
      },
      placement: 'st-visa-checkout',
      settings: {
        displayName: 'My Test Site'
      }
    });

    st.ApplePay({
      buttonStyle: 'white-outline',
      buttonText: 'plain',
      merchantId: 'merchant.net.securetrading.test',
      paymentRequest: {
        countryCode: 'US',
        currencyCode: 'USD',
        merchantCapabilities: ['supports3DS', 'supportsCredit', 'supportsDebit'],
        requiredBillingContactFields: ["postalAddress"],
        requiredShippingContactFields: ["postalAddress","name", "phone", "email"],
        supportedNetworks: ["visa","masterCard"],
        total: {
          label: 'Secure Trading Merchant',
          amount: '10.00'
        }
      },
      placement: 'st-apple-pay'
    });


    document.getElementById('update-amount').addEventListener('click', function(event) {
      event.preventDefault();
      var upJwt = '%s';
      st.updateJWT(
        upJwt
      );

    });

  })();

</script>


</body>
</html>
